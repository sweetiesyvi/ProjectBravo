<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reaction Blitz — Reaction Time Tester</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles/game.css">
</head>
<body class="bg-light">

  <header>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary" aria-label="Main navigation">
      <div class="container">
        <a class="navbar-brand" href="#">Reaction Blitz</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain" aria-controls="navMain" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navMain">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item"><button id="startBtn" class="btn btn-sm btn-light me-2 mt-2 mt-lg-0">Start / Reset</button></li>
            <li class="nav-item"><a class="nav-link" data-bs-toggle="modal" href="#howToModal" role="button">How to play</a></li>
            <li class="nav-item"><a class="nav-link" href="#dev-profile">Dev Profile</a></li>
          </ul>

          <form id="navSettings" class="d-flex" novalidate>
            <input id="playerName" name="playerName" class="form-control form-control-sm me-2" placeholder="Nom" required minlength="2" aria-label="Player name">
            <select id="difficulty" name="difficulty" class="form-select form-select-sm me-2" aria-label="Difficulty">
              <option value="easy">Easy (longer delay)</option>
              <option value="normal" selected>Normal</option>
              <option value="hard">Hard (shorter delay)</option>
            </select>
            <button class="btn btn-sm btn-outline-light" type="submit">Save</button>
          </form>
        </div>
      </div>
    </nav>
  </header>

  <main class="container my-4" id="mainContent">
    <section class="row">
      <aside class="col-lg-4 mb-3" id="sidebar">
        <div class="card mb-3">
          <div class="card-body">
            <h2 class="h6">Player</h2>
            <p>Name: <strong id="displayName">—</strong></p>
            <p>Best time: <strong id="bestTime">—</strong></p>
            <p>Attempts: <span id="attempts">0</span></p>
            <div class="mt-3 d-grid">
              <button id="resetBtn" class="btn btn-outline-primary">Reset Best</button>
            </div>
          </div>
        </div>

        <div class="card" aria-labelledby="settingsHeading">
          <div class="card-body">
            <h3 id="settingsHeading" class="h6">Settings</h3>
            <form id="settingsPanel" novalidate>
              <div class="mb-2">
                <label for="nameInput" class="form-label">Nom du joueur</label>
                <input id="nameInput" name="name" class="form-control" minlength="2" required>
                <div class="invalid-feedback">Au moins 2 caractères requis.</div>
              </div>

              <fieldset class="mb-2">
                <legend class="small mb-1">Theme</legend>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="theme" id="themeLight" value="light" checked>
                  <label class="form-check-label" for="themeLight">Light</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="theme" id="themeDark" value="dark">
                  <label class="form-check-label" for="themeDark">Dark</label>
                </div>
              </fieldset>

              <div class="d-grid">
                <button class="btn btn-primary" type="submit">Apply</button>
              </div>
            </form>
          </div>
        </div>

      </aside>

      <section class="col-lg-8" id="gameArea">
        <div class="card">
          <div class="card-body text-center">
            <h2 class="card-title">Reaction Blitz</h2>
            <p class="card-text">Wait for the screen to turn green, then click as fast as you can.</p>

            <div id="target" class="target" role="button" aria-pressed="false" tabindex="0" aria-live="polite">
              <span id="targetLabel">Click Start</span>
            </div>

            <div class="mt-3 d-flex justify-content-center gap-2">
              <button id="startRound" class="btn btn-success">Start</button>
              <button id="stopRound" class="btn btn-outline-secondary" disabled>Stop</button>
            </div>

            <div class="mt-3">
              <div>Last time: <strong id="lastTime">—</strong> ms</div>
              <div>Best time: <strong id="bestTime2">—</strong> ms</div>
            </div>

            <div class="mt-3">
              <div class="progress" style="height: 12px;">
                <div id="progressBar" class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width:0%">0%</div>
              </div>
            </div>

            <p id="message" class="small text-muted mt-2" aria-live="polite"></p>
          </div>
        </div>

        <div class="mt-3">
          <img src="images/wireframe.svg" alt="Wireframe du jeu" style="max-width:100%; height:auto;">
        </div>

      </section>
    </section>

    <div id="ariaStatus" class="visually-hidden" aria-live="polite"></div>
  </main>

  <footer class="bg-white border-top py-3">
    <div class="container d-flex justify-content-between">
      <div>
        <a id="profileLink" href="#dev-profile">Dev Profile</a> |
        <a id="repoLink" href="#" target="_blank" rel="noopener">Game Repo</a> |
        <a id="ghProfile" href="#" target="_blank" rel="noopener">GitHub</a>
      </div>
      <div>
        <a id="nuLink" href="#" target="_blank" rel="noopener">Nu HTML Validator</a> |
        <a id="waveLink" href="#" target="_blank" rel="noopener">WAVE</a>
      </div>
    </div>
  </footer>

  <!-- How to play modal (Bootstrap) -->
  <div class="modal fade" id="howToModal" tabindex="-1" aria-labelledby="howToLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 id="howToLabel" class="modal-title">How to play</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <ol>
            <li>Enter your name and choose difficulty if you want.</li>
            <li>Click <strong>Start</strong>.</li>
            <li>Wait: the target will change color after a random delay.</li>
            <li>Click the target as quickly as possible when it turns green.</li>
            <li>Your reaction time is recorded; the best time is saved in localStorage.</li>
          </ol>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Main module -->
  <script type="module">
    import Game from './scripts/game.js';
    const app = new Game({
      selectors: {
        displayName: '#displayName',
        bestTime: '#bestTime',
        bestTime2: '#bestTime2',
        attempts: '#attempts',
        target: '#target',
        targetLabel: '#targetLabel',
        startRound: '#startRound',
        stopRound: '#stopRound',
        lastTime: '#lastTime',
        progressBar: '#progressBar',
        message: '#message',
        repoLink: '#repoLink',
        ghProfile: '#ghProfile',
        nuLink: '#nuLink',
        waveLink: '#waveLink'
      }
    });
    window.app = app;
    console.log('%cEaster egg: call window.revealSecret() to toggle secret mode!', 'color:teal;font-weight:600');
    window.revealSecret = () => app.toggleSecret();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
